{
  "info": {
    "name": "PinkCapy API",
    "_postman_id": "a1b2c3d4-e5f6-7890-abcd-ef0123456789",
    "description": "Collection for PinkCapy demo API (me & admin endpoints)",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Add item to cart",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "Authorization",
            "value": "Bearer {{userToken}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\"product_id\":1,\"quantity\":2}",
          "options": { "raw": { "language": "json" } }
        },
        "url": {
          "raw": "{{baseUrl}}/me/carts/items",
          "host": ["{{baseUrl}}"],
          "path": ["me","carts","items"]
        }
      }
    },
    {
      "name": "Get cart",
      "request": {
        "method": "GET",
        "header": [
          { "key": "Authorization", "value": "Bearer {{userToken}}" }
        ],
        "url": { "raw": "{{baseUrl}}/me/carts", "host": ["{{baseUrl}}"], "path": ["me","carts"] }
      }
    },
    {
      "name": "Place order",
      "request": {
        "method": "POST",
        "header": [
          { "key": "Content-Type", "value": "application/json" },
          { "key": "Authorization", "value": "Bearer {{userToken}}" }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\"promo\":\"SUMMER2025\",\"note\":\"Giao buoi sang\"}",
          "options": { "raw": { "language": "json" } }
        },
        "url": { "raw": "{{baseUrl}}/me/orders", "host": ["{{baseUrl}}"], "path": ["me","orders"] }
      },
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "try {",
              "  var json = pm.response.json();",
              "  if (json && json.data && json.data.id) {",
              "    pm.environment.set('orderId', json.data.id);",
              "    console.log('Saved orderId:', json.data.id);",
              "  }",
              "} catch(e) { console.log('Failed to set orderId:', e); }"
            ],
            "type": "text/javascript"
          }
        }
      ]
    },
    {
      "name": "Get user order status",
      "request": {
        "method": "GET",
        "header": [ { "key": "Authorization", "value": "Bearer {{userToken}}" } ],
        "url": { "raw": "{{baseUrl}}/me/orders/{{orderId}}/status", "host": ["{{baseUrl}}"], "path": ["me","orders","{{orderId}}","status"] }
      }
    },
    {
      "name": "Admin get order status",
      "request": {
        "method": "GET",
        "header": [ { "key": "Authorization", "value": "Bearer {{adminToken}}" } ],
        "url": { "raw": "{{baseUrl}}/admin/orders/{{orderId}}/status", "host": ["{{baseUrl}}"], "path": ["admin","orders","{{orderId}}","status"] }
      }
    },
    {
      "name": "Admin confirm order",
      "request": {
        "method": "PUT",
        "header": [ { "key": "Authorization", "value": "Bearer {{adminToken}}" } ],
        "url": { "raw": "{{baseUrl}}/admin/orders/{{orderId}}/confirm", "host": ["{{baseUrl}}"], "path": ["admin","orders","{{orderId}}","confirm"] }
      }
    }
  ]
}
